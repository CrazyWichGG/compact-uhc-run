#set default is dropped book
execute as @a at @s unless score @s custom-gambling-is-dropped-book = @s custom-gambling-is-dropped-book run scoreboard players set @s custom-gambling-is-dropped-book 0
#set default bet amount
execute as @a at @s unless score @s custom-gambling-set-bet-amount = @s custom-gambling-set-bet-amount run scoreboard players set @s custom-gambling-set-bet-amount 1
#set default is spinning
execute as @a at @s unless score @s custom-gambling-is-spinning = @s custom-gambling-is-spinning run scoreboard players set @s custom-gambling-is-spinning 0
#set default is winning
execute as @a at @s unless score @s custom-gambling-is-winning = @s custom-gambling-is-winning run scoreboard players set @s custom-gambling-is-winning 0

#player emerald count
execute as @a at @s store result score @s custom-gambling-emerald-count run clear @s emerald 0

#actionbar
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if items entity @s weapon.mainhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run title @s actionbar [{"text":"Press "},{"text":"[","color":"gold"},{"keybind":"key.use","color":"gold"},{"text":"]","color":"gold"},{"text":" to set your bet and "},{"text":"[","color":"gold"},{"keybind":"key.drop","color":"gold"},{"text":"]","color":"gold"},{"text":" to spin!"},{"text":" | ","color":"gray"},{"text":"Current Bet: ","color":"gold"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if items entity @s weapon.offhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run title @s actionbar [{"text":"Press "},{"text":"[","color":"gold"},{"keybind":"key.use","color":"gold"},{"text":"]","color":"gold"},{"text":" to set your bet and "},{"text":"[","color":"gold"},{"keybind":"key.swapOffhand","color":"gold"},{"text":"]","color":"gold"},{"text":" then "},{"text":"[","color":"gold"},{"keybind":"key.drop","color":"gold"},{"text":"]","color":"gold"},{"text":" to spin!"},{"text":" | ","color":"gray"},{"text":"Current Bet: ","color":"gold"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if predicate system:is_sneaking if items entity @s weapon.mainhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run title @s actionbar [{"text":""},{"text":"Skip Animation is "},{"text":"ON","color":"green","bold":true},{"text":"! Press "},{"text":"[","color":"gold"},{"keybind":"key.drop","color":"gold"},{"text":"]","color":"gold"},{"text":" to spin!"},{"text":" | ","color":"gray"},{"text":"Current Bet: ","color":"gold"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if predicate system:is_sneaking if items entity @s weapon.offhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run title @s actionbar [{"text":""},{"text":"Skip Animation is "},{"text":"ON","color":"green","bold":true},{"text":"! Press "},{"text":"[","color":"gold"},{"keybind":"key.swapOffhand","color":"gold"},{"text":"]","color":"gold"},{"text":" then "},{"text":"[","color":"gold"},{"keybind":"key.drop","color":"gold"},{"text":"]","color":"gold"},{"text":" to spin!"},{"text":" | ","color":"gray"},{"text":"Current Bet: ","color":"gold"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}}]

#update book
execute if score gambling custom matches 1 as @a at @s if items entity @s weapon.mainhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run item modify entity @s weapon.mainhand system:update_slot_item
execute if score gambling custom matches 1 as @a at @s if items entity @s weapon.offhand written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run item modify entity @s weapon.offhand system:update_slot_item

#enable trigger scoreboard
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if items entity @s weapon.* written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run scoreboard players enable @s custom-gambling-set-bet-amount-trigger
execute if score gambling custom matches 1 as @a at @s unless items entity @s weapon.* written_book[minecraft:custom_data={custom_item:"gambling_slot"}] run trigger custom-gambling-set-bet-amount-trigger add 0
execute if score gambling custom matches 0 as @a at @s run trigger custom-gambling-set-bet-amount-trigger add 0

#check if trigger score
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-set-bet-amount-trigger matches 1.. run scoreboard players operation @s custom-gambling-set-bet-amount = @s custom-gambling-set-bet-amount-trigger
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-set-bet-amount-trigger matches 1.. if score @s custom-gambling-set-bet-amount matches 1 run tellraw @s [{"text":"You have set your bet to ","color":"green"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}},{"text":" emerald"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-set-bet-amount-trigger matches 1.. if score @s custom-gambling-set-bet-amount matches 2.. run tellraw @s [{"text":"You have set your bet to ","color":"green"},{"score":{"name":"@s","objective":"custom-gambling-set-bet-amount"}},{"text":" emeralds"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-set-bet-amount-trigger matches 1.. run playsound entity.villager.yes master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-set-bet-amount-trigger matches 1.. run scoreboard players set @s custom-gambling-set-bet-amount-trigger 0

#when drop
# -is spinning
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] unless items entity @s weapon.mainhand * run loot replace entity @s weapon.mainhand loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] if items entity @s weapon.mainhand * run loot give @s loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 run tellraw @s [{"text":"You are still spinning!","color":"red"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 run playsound block.note_block.bass master @s ~ ~ ~ 1 0 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 run kill @e[type=item,limit=1,sort=nearest,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. unless entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 1 run scoreboard players set @s custom-gambling-is-dropped-book 0
# -is not spinning (not enough emerald)
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] unless items entity @s weapon.mainhand * run loot replace entity @s weapon.mainhand loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] if items entity @s weapon.mainhand * run loot give @s loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount run tellraw @s [{"text":"You don't have enough emeralds","color":"red"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount run playsound entity.villager.no master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount run kill @e[type=item,limit=1,sort=nearest,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. unless entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count < @s custom-gambling-set-bet-amount run scoreboard players set @s custom-gambling-is-dropped-book 0
# -is not spinning
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-dropped-book matches 1.. if entity @e[type=item,limit=1,sort=nearest,distance=..3,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}] if score @s custom-gambling-is-spinning matches 0 if score @s custom-gambling-emerald-count >= @s custom-gambling-set-bet-amount run scoreboard players set @s custom-gambling-is-spinning 1

#spinning
# -time
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning matches 1 run scoreboard players add @s custom-gambling-is-spinning-time 1
# -return book
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] unless items entity @s weapon.mainhand * run loot replace entity @s weapon.mainhand loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 unless items entity @s container.* written_book[minecraft:custom_data={custom_item:gambling_slot}] if items entity @s weapon.mainhand * run loot give @s loot system:custom_item/gambling_slot_item
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run kill @e[type=item,limit=1,sort=nearest,nbt={Item:{id:"minecraft:written_book",components:{"minecraft:custom_data":{custom_item:gambling_slot}}}}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players set @s custom-gambling-is-dropped-book 0
# -title times
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run title @s times 0 100 20
# -set playing bet
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @s custom-gambling-bet-amount = @s custom-gambling-set-bet-amount
# -remove emerald
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 1 run clear @s emerald 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 2 run clear @s emerald 2
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 4 run clear @s emerald 4
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 8 run clear @s emerald 8
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 16 run clear @s emerald 16
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 32 run clear @s emerald 32
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-bet-amount matches 64 run clear @s emerald 64
# -set pre reward amount
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @s custom-gambling-bet-amount = @s custom-gambling-set-bet-amount
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players set @s custom-gambling-reward-3reels 5
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players set @s custom-gambling-reward-4reels 20
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players set @s custom-gambling-reward-5reels 100
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @s custom-gambling-reward-3reels *= @s custom-gambling-bet-amount
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @s custom-gambling-reward-4reels *= @s custom-gambling-bet-amount
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @s custom-gambling-reward-5reels *= @s custom-gambling-bet-amount
# -randomize number
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 store result score @s custom-gambling-reel1 run random value 0..3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 store result score @s custom-gambling-reel2 run random value 0..3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 store result score @s custom-gambling-reel3 run random value 0..3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 store result score @s custom-gambling-reel4 run random value 0..3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 store result score @s custom-gambling-reel5 run random value 0..3
# -check if winning
# # -5 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-5reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players set @s custom-gambling-is-winning 5
# # -4 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-4reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 run scoreboard players set @s custom-gambling-is-winning 4
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-4reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players set @s custom-gambling-is-winning 4
# # -3 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-3reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel1 = @s custom-gambling-reel2 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 run scoreboard players set @s custom-gambling-is-winning 3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-3reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel2 = @s custom-gambling-reel3 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 run scoreboard players set @s custom-gambling-is-winning 3
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players operation @s custom-gambling-reward-pool = @s custom-gambling-reward-3reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-is-winning matches 0 if score @s custom-gambling-reel3 = @s custom-gambling-reel4 if score @s custom-gambling-reel4 = @s custom-gambling-reel5 run scoreboard players set @s custom-gambling-is-winning 3
# -summon marker to store animation text & its behavior
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run summon marker ~ ~ ~ {data:{SlotResultTranslate:[],OwnerUUID:[]},Tags:["gambling-slot-player-data"]}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..1] data.OwnerUUID set from entity @s UUID[0]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run scoreboard players operation @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..1] custom-gambling-marker-owner-uuid = @s player-uuid
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1.. run tp @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] ~ ~ ~

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel1 matches 0 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♥","color":"red"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel1 matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♦","color":"aqua"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel1 matches 2 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♣","color":"green"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel1 matches 3 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♠","color":"gold"}

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel2 matches 0 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♥","color":"red"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel2 matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♦","color":"aqua"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel2 matches 2 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♣","color":"green"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel2 matches 3 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♠","color":"gold"}

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel3 matches 0 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♥","color":"red"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel3 matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♦","color":"aqua"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel3 matches 2 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♣","color":"green"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel3 matches 3 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♠","color":"gold"}

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel4 matches 0 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♥","color":"red"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel4 matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♦","color":"aqua"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel4 matches 2 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♣","color":"green"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel4 matches 3 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♠","color":"gold"}

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel5 matches 0 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♥","color":"red"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel5 matches 1 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♦","color":"aqua"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel5 matches 2 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♣","color":"green"}
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if score @s custom-gambling-reel5 matches 3 run data modify entity @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3] data.SlotResultTranslate append value {"text":"♠","color":"gold"}

# -play animation
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run title @s subtitle [{"text":"Spinning...","color":"yellow"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 run title @s title [{"text":"[ ","color":"white"},{"text":"?","color":"gray"},{"text":" | "},{"text":"?","color":"gray"},{"text":" | "},{"text":"?","color":"gray"},{"text":" | "},{"text":"?","color":"gray"},{"text":" | "},{"text":"?","color":"gray"},{"text":" ]"}]

# -skip animation
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 1 if predicate system:is_sneaking run scoreboard players set @s custom-gambling-is-spinning-time 60

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 20 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" ]","obfuscated":false}]

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 40 run playsound block.note_block.hat master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 40 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" ]","obfuscated":false}]

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 45 run playsound block.note_block.hat master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 45 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[1]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" ]","obfuscated":false}]

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 50 run playsound block.note_block.hat master @s
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 50 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[1]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[2]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" ]","obfuscated":false}]

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 55 run playsound block.note_block.hat master @s
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 55 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[1]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[2]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[3]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"text":"?","color":"gray","obfuscated":true},{"text":" ]","obfuscated":false}]
# # -lost
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 0 run playsound entity.villager.death master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 0 run title @s subtitle [{"text":"You lost!","color":"red"}]
# # -win 3 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 3 run playsound entity.player.levelup master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 3 run title @s subtitle [{"text":"You won ","color":"green"},{"score":{"name":"@s","objective":"custom-gambling-reward-pool"}},{"text":" emeralds!","color":"green"}]
# # -win 4 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 4 run playsound entity.player.levelup master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 4 run title @s subtitle [{"text":"You won ","color":"green"},{"score":{"name":"@s","objective":"custom-gambling-reward-pool"}},{"text":" emeralds!","color":"green"}]
# # -win 5 reels
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 run playsound ui.toast.challenge_complete master @s ~ ~ ~ 1 1 1
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 run title @s subtitle [{"text":"You won a ","color":"green"},{"text":"JACKPOT","color":"gold","bold":true},{"text":" and ","color":"green"},{"score":{"name":"@s","objective":"custom-gambling-reward-pool"},"color":"green"},{"text":" emeralds!","color":"green"}]
# # -give reward
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 if score @s custom-gambling-reel1 matches 0 run loot spawn ~ ~ ~ loot system:gambling_reward/jackpot_heart
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 if score @s custom-gambling-reel1 matches 1 run loot spawn ~ ~ ~ loot system:gambling_reward/jackpot_diamond
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 if score @s custom-gambling-reel1 matches 2 run loot spawn ~ ~ ~ loot system:gambling_reward/jackpot_club
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 if score @s custom-gambling-reel1 matches 3 run loot spawn ~ ~ ~ loot system:gambling_reward/jackpot_spade
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 5 run tellraw @a [{"selector":"@s","color":"green"},{"text":" won a "},{"text":"JACKPOT","color":"gold","bold":true},{"text":" ("},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":") and "},{"score":{"name":"@s","objective":"custom-gambling-reward-pool"}},{"text":" emeralds on "},{"score":{"name":"@s","objective":"custom-gambling-bet-amount"}},{"text":" emerald(s) bet!","color":"green"}]
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 3.. run loot spawn ~ ~ ~ loot system:gambling_reward/emerald
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 if score @s custom-gambling-is-winning matches 3.. as @e[type=item,distance=..3] run data modify entity @s PickupDelay set value 0

execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 run title @s title [{"text":"[ ","color":"white","obfuscated":false},{"nbt":"data.SlotResultTranslate[0]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[1]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[2]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[3]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" | ","obfuscated":false},{"nbt":"data.SlotResultTranslate[4]","entity":"@e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest,distance=..3]","interpret":true},{"text":" ]","obfuscated":false}]
# -remove marker
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 60 run kill @e[type=marker,tag=gambling-slot-player-data,limit=1,sort=nearest]
# -remove winning
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 62 run scoreboard players set @s custom-gambling-is-winning 0
# -reset reward pool
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 62 run scoreboard players set @s custom-gambling-reward-pool 0
# -stop spinning
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 62 run scoreboard players set @s custom-gambling-is-spinning 0
execute if score gambling custom matches 1 as @a[team=!spectator] at @s if score @s custom-gambling-is-spinning-time matches 62 run scoreboard players set @s custom-gambling-is-spinning-time 0



#book not match condition
execute as @a at @s run scoreboard players set @s custom-gambling-is-dropped-book 0
